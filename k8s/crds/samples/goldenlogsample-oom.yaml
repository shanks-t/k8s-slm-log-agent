apiVersion: intelligence.homelab.io/v1alpha1
kind: GoldenLogSample
metadata:
  name: oom-killed-pod-001
  namespace: default
  labels:
    category: infra-pod-failure
    severity: critical
    difficulty: easy
spec:
  # Raw log entry
  logEntry: |
    {"level":"error","ts":"2025-12-14T10:23:45.123Z","namespace":"default","pod":"myapp-6d5f8-abc","container":"myapp","msg":"Container myapp in pod myapp-6d5f8-abc terminated: OOMKilled"}

  # Context information
  context:
    timestamp: "2025-12-14T10:23:45Z"
    namespace: "default"
    pod: "myapp-6d5f8-abc"
    container: "myapp"
    node: "node-2"
    cluster: "homelab"

  # Ground truth labels
  groundTruth:
    rootCause: "memory-limit-exceeded"
    severity: "CRITICAL"
    component: "pod-lifecycle"
    summary: "Pod terminated due to exceeding memory limits (OOMKilled). Container was using more memory than the configured limit."
    recommendedAction: "increase-memory-limits"
    tags:
      - oom
      - resource-limit
      - pod-failure
      - memory

  # Sample metadata
  category: infra-pod-failure
  source: real
  difficulty: easy
  notes: "Common Kubernetes failure mode - pod exceeds memory limit"

---
apiVersion: intelligence.homelab.io/v1alpha1
kind: GoldenLogSample
metadata:
  name: image-pull-error-001
  namespace: default
  labels:
    category: infra-pod-failure
    severity: error
    difficulty: easy
spec:
  logEntry: |
    {"level":"error","ts":"2025-12-14T11:15:32.456Z","namespace":"default","pod":"nginx-test-xyz","msg":"Failed to pull image nginx:nonexistent: rpc error: code = NotFound desc = failed to pull and unpack image"}

  context:
    timestamp: "2025-12-14T11:15:32Z"
    namespace: "default"
    pod: "nginx-test-xyz"
    node: "node-1"

  groundTruth:
    rootCause: "image-not-found"
    severity: "ERROR"
    component: "image-pull"
    summary: "Pod unable to start because the specified container image does not exist in the registry"
    recommendedAction: "verify-image-tag-exists"
    tags:
      - image-pull
      - registry
      - pod-startup

  category: infra-pod-failure
  source: real
  difficulty: easy
  notes: "Common error when image tag is misspelled or doesn't exist"

---
apiVersion: intelligence.homelab.io/v1alpha1
kind: GoldenLogSample
metadata:
  name: network-timeout-001
  namespace: default
  labels:
    category: infra-network-error
    severity: warn
    difficulty: medium
spec:
  logEntry: |
    {"level":"warn","ts":"2025-12-14T14:22:11.789Z","namespace":"logging","pod":"loki-0","msg":"context deadline exceeded calling Loki query-frontend from Grafana Alloy on node-1"}

  context:
    timestamp: "2025-12-14T14:22:11Z"
    namespace: "logging"
    pod: "loki-0"
    node: "node-2"

  groundTruth:
    rootCause: "network-timeout-cross-node"
    severity: "WARN"
    component: "network"
    summary: "Cross-node network communication timeout between Grafana Alloy on node-1 and Loki on node-2, possibly due to VXLAN tunnel issues"
    recommendedAction: "check-vxlan-port-8472-firewall"
    tags:
      - network
      - timeout
      - cross-node
      - vxlan
      - flannel

  category: infra-network-error
  source: real
  difficulty: medium
  notes: "This is specific to our homelab - UDP port 8472 for Flannel VXLAN must be open"

---
apiVersion: intelligence.homelab.io/v1alpha1
kind: GoldenLogSample
metadata:
  name: pvc-pending-001
  namespace: default
  labels:
    category: infra-storage-issue
    severity: warn
    difficulty: medium
spec:
  logEntry: |
    {"level":"warn","ts":"2025-12-14T09:10:45.234Z","namespace":"llm","pod":"llama-cpp-abc","msg":"PersistentVolumeClaim is not bound: llama-models-pvc"}

  context:
    timestamp: "2025-12-14T09:10:45Z"
    namespace: "llm"
    pod: "llama-cpp-abc"
    node: "node-2"

  groundTruth:
    rootCause: "pvc-not-bound"
    severity: "WARN"
    component: "storage"
    summary: "Pod cannot start because its PersistentVolumeClaim is not bound to a PersistentVolume. Possible causes: no matching PV available, incorrect storage class, or nodeAffinity mismatch"
    recommendedAction: "check-pv-availability-and-affinity"
    tags:
      - storage
      - pvc
      - pv
      - binding
      - scheduling

  category: infra-storage-issue
  source: real
  difficulty: medium
  notes: "Common issue when PV nodeAffinity doesn't match the pod's node assignment"

---
apiVersion: intelligence.homelab.io/v1alpha1
kind: GoldenLogSample
metadata:
  name: app-null-pointer-001
  namespace: default
  labels:
    category: app-error
    severity: error
    difficulty: hard
spec:
  logEntry: |
    {"level":"error","ts":"2025-12-14T15:33:21.567Z","service":"log-analyzer","endpoint":"/v1/analyze","msg":"NoneType object has no attribute 'get'","traceback":"File 'analyzer.py', line 142, in extract_root_cause\n    cause = result.get('root_cause')\nAttributeError: NoneType"}

  context:
    timestamp: "2025-12-14T15:33:21Z"
    namespace: "log-analyzer"
    pod: "log-analyzer-api-xyz"
    container: "fastapi"

  groundTruth:
    rootCause: "null-pointer-llm-response"
    severity: "ERROR"
    component: "log-analyzer-api"
    summary: "Application error in log analyzer service - LLM returned None instead of expected JSON object, causing AttributeError when accessing result fields"
    recommendedAction: "add-null-check-for-llm-response"
    tags:
      - application-error
      - null-pointer
      - llm-integration
      - python

  category: app-error
  source: synthetic
  difficulty: hard
  notes: "Requires understanding the application context and LLM integration pattern to identify root cause"
